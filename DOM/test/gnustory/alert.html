<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title></title>
</head>
<body>

<script src="../../../../bsJS/bsjs.0.5.js"></script>

<script>
    var testGlobal;
    //bs.plugin( 'markdown', null, 'ui', null );
    bs(function (){

        bs.ui = (function(){
            var r = bs.rand, rf = bs.randf, isMobile = bs.DETECT.device === 'mobile' ? true : false;

            return {
                alert:function( title, msg, buttons, handler, time, durationTime, ease, parent ){

                    var inited, init = function(){
                        inited = 1;
                        bs.Css('#bsUI_alert').S( 'overflow', 'hidden', 'position', 'fixed', 'background', '#2b2b2f', 'z-index', 999999999 );
                    };

                    var alert = function(){
                        if( arguments[0] ) alertQue.push(arguments);
                        if( alerted || !alertQue.length ){
                            if(!alertQue.length) overlay.S(null), overlay = null;
                            return;
                        }
                        alerted = 1, curr = alertQue.pop();
                        if( !dom ) {
                            dom = bs.Dom('<div id="bsUI_alert"></div>')
                                    .S('<', 'body', 'border-radius', 100, 'top', '50%', 'left', '0:%',
                                    'width', '', 'height', '', 'margin-left', 0, 'margin-top', 0,
                                    'display', 'block', 'opacity', 0, 'this');
                            t = bs.Dom('<div id="bsUI_alert_title"></div>').S('<', '#bsUI_alert', 'opacity', 0, 'this');
                            m = bs.Dom('<div id="bsUI_alert_msg"></div>').S('<', '#bsUI_alert', 'opacity', 0, 'this');
                            b = bs.Dom('<div id="bsUI_alert_btns"></div>').S('<', '#bsUI_alert', 'opacity', 0, 'width', '100%', 'text-align', 'center', 'this');
                        }
                        t.S('html', curr[0]), m.S('html', curr[1]), b.S('html', curr[2]);
                        setSize();
                        setHandler();
                        bs.ANI.style( dom.S( 'display', 'block', 'width', 0, 'height', 0, 'left', 50, 'this' ),
                                'opacity', 1, 'width', w, 'height', h, 'margin-left', ml, 'margin-top', mt, 'border-radius', 10,
                                'time', curr[4] || .5, 'ease', curr[6] || 'backOut', 'end', showEnd,
                                'update', particle
                        );
                        if(!overlay) overlay = bs.Dom('<div id="bsUI_overlay"></div>').S('<', 'body', 'this');
                    },
                    showEnd = function(){
                        bs.ANI.style( t, 'opacity', 1, 'time', .3), bs.ANI.style( m, 'opacity', 1, 'delay', .1, 'time', .3), bs.ANI.style( b, 'opacity', 1, 'delay', .2, 'time', .3);
                    },
                    hide = function(){
                        bs.ANI.style( b, 'opacity', 0, 'time', .3), bs.ANI.style( m, 'opacity', 0, 'delay', .1, 'time', .3), bs.ANI.style( t, 'opacity', 0, 'delay', .2, 'time', .3);
                        bs.ANI.style( dom.S('opacity', 1, 'width', w, 'height', h, 'this'),
                                'opacity', 0, 'width', 0, 'height', 0, 'margin-left', 0, 'margin-top', 0, 'border-radius', 100,
                                'delay', .5, 'time', curr[4] || .5, 'ease', curr[6] || 'backIn', 'end', hideEnd,
                                'update', particle
                        );
                    },
                    hideEnd = function (){
                        dom.S( 'width', 0, 'height', 0, 'left', 0, 'opacity', 0, 'margin-left', 0, 'margin-top', 0, 'display', 'none' ),
                                t.S('html', ''), m.S('html', ''), b.S('html', ''),
                                alerted = 0, alert();
                    },
                    particle = function( target, rate, T ){
                        particleCnt++;
                        if(isMobile && particleCnt%2) return;
                        var i = isMobile ? r( 0, 2 ) : r( 2, 5 ), x, y, s, d, j=0, k=false;
                        while(i--) j = i%2, k = j ? !k : k, bs.ANI.style(
                                bs.Dom('<div></div>' ).S(
                                        'background', 'rgb('+r(150,255)+','+r(150,255)+','+r(150,255)+')',
                                        'border-radius', 100, 'position','fixed', '<', 'body',
                                        'display', 'block', 'width',10, 'height',10,
                                        'left', ( x = ( 1 + ( j ? -rate *.5 : rate *.5 ) ) * 50 ) + ':%',
                                        'top', ( y = ( 1 + ( k ? -rate *.6 : rate *.6 ) ) * 50 ) + ':%',
                                        'opacity', 1, 'z-index', 100000000, 'this'
                                ),
                                'left', r( -10, 10 ) + x, 'top', r( -20, 20 ) + y,
                                'width', s = r( 30, 60 ), 'height',s, 'opacity', 0,
                                'time', rf( .5, 1.5 ), 'end', particleEnd
                        );
                    },
                    particleEnd = function(target){target.S(null);},
                    setSize = function (){
                        maxW = window.innerWidth ? window.innerWidth*.8 : document.documentElement.clientWidth*.8;
                        if(maxW < minW) maxW = minW;

                        dom.S('width', null, 'height', null, 'display', 'block');

                        w = dom.S('w'), w > maxW ? w = maxW : (w < minW ? w = minW : 0), dom.S('width', w);
                        h = dom.S('h');
                        ml = -w*.5, mt = -h*.5;
                    },
                    setHandler = function (){
                        var btn, btnArr = bs.Dom(b.S('>')).S('>'), i = btnArr.length;
                        while(i--) btn = bs.Dom(btnArr[i]), btn.S('*click-index', i, 'click', btnClickHandler);
                    },
                    btnClickHandler = function (){
                        curr[3]({
                            index : bs.Dom(this).S('*click-index')
                        });
                        hide();
                    },
                    alerted, alertQue = [], dom, t, m, b, curr, w, h, ml, mt, maxW, minW = 20, particleCnt=0, overlay;

                    if( !inited ) init();
                    (this.alert = alert).apply( this, arguments );
                }
            };
        })();

        bs.Css('body').S('padding', 0, 'margin', 0);
        bs.Css('#bsUI_alert').S('text-align', 'center');
        bs.Css('.title').S( 'color', '#eeff41', 'text-align', 'center', 'font-size', '2em', 'padding', '10px 10px' );
        bs.Css('.msg').S( 'color', '#ffffff', 'text-align', 'center', 'font-size', '1em', 'padding', '10px 10px' );
        bs.Css('.btns').S('padding', '10px 10px');
        bs.Css('.btns button').S( 'width', 100, 'color', '#000000', 'text-align', 'center', 'font-size', '1em', 'padding', '10px 10px', 'margin', '5px 5px' );
        bs.Css('#bsUI_overlay').S('background-color', '#000000', 'width', '100%', 'height', '100%', 'position', 'fixed', 'top', 0, 'left', 0, 'opacity', .5, 'z-index', 99999999);

        bs.ui.alert( '<div class="title">1. gnustory title</div>',
                        '<div class="msg">message area!<br>숫자가 값이면 자동으로 px 사용특정 단위를 <br>' +
                        '지정하고 싶은 경우 "XXX:unit" 형식 사용<br>' +
                        '"100%" 인 경우는 그 이후도 문자열 처리되지만, <br>' +
                        '"100:%"인 경우 최초 설정 이후는 숫자 사용 가능</div>',
                '<div class="btns"><button type="button">확인</button><button type="button">취소</button></div>',
                function (data){
                    document.getElementById('output').innerHTML += 'button index : ' + data.index + '<br>';
                },
                .5 );

        bs.ui.alert( '<div class="title">2. gnustory title</div>',
                        '<div class="msg">message area!<br>숫자가 값이면 자동으로 px 사용특정 단위를 지정하고 싶은 경우 "XXX:unit" 형식 사용"100%" 인 경우는 그 이후도 문자열 처리되지만, "100:%"인 경우 최초 설정 이후는 숫자 사용 가능</div>',
                '<div class="btns"><button type="button">확인</button></div>',
                function (data){
                    document.getElementById('output').innerHTML += 'button index : ' + data.index + '<br>';
                },
                .5 );

    });


</script>

<div id="output" style="padding:20px; width:200px; height:200px; overflow-x:hidden; overflow-y: auto; background-color: #000000; color: #ffffff;"></div>

</body>
</html>